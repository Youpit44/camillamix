
# dac8x_streamer_44c_192p_tone.yml
# CamillaDSP v3 configuration example for RPi5 + HiFiBerry DAC8x
# Capture at 44.1 kHz from ALSA Loopback, playback at 192 kHz to 8 DAC8x outputs
# Adds per-output tone controls: Bass (lowshelf), Mid (peaking), Treble (highshelf)
# NOTE: Adjust capture/playback device names to your system (aplay -l)
#       If your player does not output 44.1 kHz fixed, set it fixed or add a rate-switcher.
# Personnalisation rapide (si tu veux une “house curve”)
#
# Graves : passe freq: à 80–120 Hz et gain: à +1 à +6 dB selon le goût.
# Aigus : ajuste freq: à 5–10 kHz, gain: ±0 à ±3 dB.
# Médiums : joue sur freq: 0,8–1,2 kHz, gain: ±1–±3 dB, q: 0,7–1,2.

title: "DAC8x Streamer 44c → 192p + Tone"
description: "Streamer loopback capture at 44.1 kHz, resampled to 192 kHz playback on DAC8x, with per-channel Bass/Mid/Treble biquads."

# --- Devices ---
devices:
  samplerate: 192000
  chunksize: 4096   # Suggested size for 176.4/192 kHz (≈21 ms) 
  capture:
    type: Alsa
    channels: 2
    device: "hw:Loopback,1"     # Adjust to your loopback device
    format: S32LE
  playback:
    type: Alsa
    channels: 8
    device: "hw:0,0"            # Adjust to your DAC8x ALSA device
    format: S32LE
  # Optional rate adjust (helps drift correction when capture/playback share clock)
  enable_rate_adjust: false
  capture_samplerate: 44100

# --- Resampler (CamillaDSP v3) ---
# If your GUI shows a different syntax, you can remove this block and let GUI manage resampling.
resampler:
  type: SincBest
  parameters:
    # Default parameters are fine; GUI can override if needed
    # You can choose SincMedium for lower CPU usage
    passband_end: 0.98
    stopband_begin: 1.02

# --- Mixers (2 in -> 8 out) ---
mixers:
  to8:
    description: "Expand 2 channels (L/R) to 8 outputs for DAC8x"
    channels:
      in: 2
      out: 8
    mapping:
      - dest: 0
        sources:
          - { channel: 0, gain: 0.0, inverted: false }
      - dest: 1
        sources:
          - { channel: 1, gain: 0.0, inverted: false }
      - dest: 2
        sources:
          - { channel: 0, gain: 0.0, inverted: false }
      - dest: 3
        sources:
          - { channel: 1, gain: 0.0, inverted: false }
      - dest: 4
        sources:
          - { channel: 0, gain: 0.0, inverted: false }
      - dest: 5
        sources:
          - { channel: 1, gain: 0.0, inverted: false }
      - dest: 6
        sources:
          - { channel: 0, gain: 0.0, inverted: false }
      - dest: 7
        sources:
          - { channel: 1, gain: 0.0, inverted: false }

# --- Filters (tone controls per output channel) ---
filters:
  # Channel 0
  Bass_0:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_0:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_0: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 1
  Bass_1:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_1:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_1: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 2
  Bass_2:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_2:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_2: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 3
  Bass_3:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_3:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_3: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 4
  Bass_4:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_4:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_4: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 5
  Bass_5:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_5:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_5: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 6
  Bass_6:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_6:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_6: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }
  # Channel 7
  Bass_7:   { type: Biquad, parameters: { type: Lowshelf,  freq: 90,   q: 0.9, gain: 0.0 } }
  Mid_7:    { type: Biquad, parameters: { type: Peaking,   freq: 1000, q: 1.0, gain: 0.0 } }
  Treble_7: { type: Biquad, parameters: { type: Highshelf, freq: 6500, q: 0.7, gain: 0.0 } }

# --- Pipeline ---
pipeline:
  # 1) Expand L/R to 8 outputs
  - type: Mixer
    name: to8

  # 2) Apply tone controls per channel
  - type: Filter
    channel: 0
    names: [Bass_0, Mid_0, Treble_0]
  - type: Filter
    channel: 1
    names: [Bass_1, Mid_1, Treble_1]
  - type: Filter
    channel: 2
    names: [Bass_2, Mid_2, Treble_2]
  - type: Filter
    channel: 3
    names: [Bass_3, Mid_3, Treble_3]
  - type: Filter
    channel: 4
    names: [Bass_4, Mid_4, Treble_4]
  - type: Filter
    channel: 5
    names: [Bass_5, Mid_5, Treble_5]
  - type: Filter
    channel: 6
    names: [Bass_6, Mid_6, Treble_6]
  - type: Filter
    channel: 7
    names: [Bass_7, Mid_7, Treble_7]
